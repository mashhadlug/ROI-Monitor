{% extends 'layout.html' %}
{% block content %}
<div id="page-wrapper">

  <div class="row">
    <div class="col-lg-12">
      <h1>Sensors <small>All Sensors</small></h1>
      <ol class="breadcrumb">
        <li><a href="index.html"><i class="fa fa-dashboard"></i> Dashboard</a></li>
        <li class="active"><i class="fa fa-table"></i> Sensors</li>
      </ol>
      {% with messages = get_flashed_messages(with_categories=true) %}
        {% if messages %}
          {% for category, message in messages %}
              <div class="alert alert-{{ category }} alert-dismissable">
                <button type="button" class="close" data-dismiss="alert" aria-hidden="true">&times;</button>
                {{ message }}
              </div>
          {% endfor %}
        {% endif %}
      {% endwith %}
    </div>
  </div><!-- /.row -->

  <div class="row">
    <div class="col-lg-6">
      <form role="form" method="POST">
        <div class="form-group">
          {{ form.name.label }}
          {{ form.name(size=20, class="form-control", placeholder="Sensor's Name") }}
        </div>
        <div class="form-group">
          {{ form.pin.label }}
          {{ form.pin(size=2, class="form-control", placeholder="Sensor's Pin") }}
        </div>
        <div class="form-group">
          {{ form.csrf_token }}
          <button type="submit" class="btn btn-default">Submit</button>
        </div>
      </form>
    </div>
    <div class="col-lg-6">
      <h1>Help</h1>
      <p>For complete documentation, please visit <a href="http://getbootstrap.com/css/#forms">Bootstrap's Form Documentation</a>.</p>
    </div>
  </div><!-- /.row -->


  <div class="row">
    <div class="col-lg-12">
      <!--<h2>Bordered Table</h2>-->
      <div class="table-responsive">
        <table class="table table-bordered table-hover tablesorter">
          <thead>
            <tr>
              <th>Row <i class="fa fa-sort"></i></th>
              <th>Name <i class="fa fa-sort"></i></th>
              <th>Pin Number <i class="fa fa-sort"></i></th>
              <th>Status <i class="fa fa-sort"></i></th>
              <th>Created <i class="fa fa-sort"></i></th>
              <th>Modified <i class="fa fa-sort"></i></th>
              <th></th>
            </tr>
          </thead>
          <tbody>
            {% for sensor in sensors %}
            <tr>
                <td>{{ sensor.id }}</td>
                <td>{{ sensor.name }}</td>
                <td>{{ sensor.pin }}</td>
                <td>STATUS</td>
                <td>{{ sensor.created_at }}</td>
                <td>{{ sensor.modified_at }}</td>
                <td>
                  <button class="btn btn-link" data-toggle="modal" data-target="#sensorModal{{ loop.index }}">
                    <i class="fa fa-edit"></i> edit
                  </button>

                  <!-- Modal -->
                  <div class="modal fade" id="sensorModal{{ loop.index }}" tabindex="-1" role="dialog" aria-labelledby="myModalLabel" aria-hidden="true">
                    <form role="form" method="POST" action="{{ url_for('sensors.update', id=sensor.id) }}">
                      <div class="modal-dialog">
                        <div class="modal-content">
                          <div class="modal-header">
                            <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                            <h4 class="modal-title" id="myModalLabel">Sensor's Edit Modal</h4>
                          </div>
                          <div class="modal-body">
                              <div class="form-group">
                                {{ form.name.label }}
                                {{ form.name(value=sensor.name, size=20, class="form-control", placeholder="Sensor's Name") }}
                              </div>
                              <div class="form-group">
                                {{ form.pin.label }}
                                {{ form.pin(value=sensor.pin, size=2, class="form-control", placeholder="Sensor's Pin") }}
                              </div>
                              <div class="form-group">
                                {{ form.csrf_token }}
                                <button type="submit" class="btn btn-default">Submit</button>
                              </div>
                          </div>
                          <div class="modal-footer">
                            <button type="button" class="btn btn-default pull-left" data-dismiss="modal">Close</button>
                            <button type="button" class="btn btn-primary">Save changes</button>
                          </div>
                        </div>
                      </div>
                    </form>
                  </div>
                  <!-- /.Modal -->
                </td>
            </tr>
            {% endfor %}
          </tbody>
        </table>
      </div>
    </div>
  </div><!-- /.row -->

</div><!-- /#page-wrapper -->
{% endblock %}
